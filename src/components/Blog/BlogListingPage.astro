---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import type { BlogPostContent } from '../../data/blogs/content';

const {
  posts = [],
  currentPage = 1,
  totalPages = 1,
  heading = 'AI Blogs in Virginia',
  description = 'Stay ahead with weekly insights on how Virginia businesses, agencies, and nonprofits deploy AI to work smarter. Our Binary Ideas strategists break down compliance, workflows, and customer expectations across the Commonwealth, so your local team can move from experiments to full-scale automation with confidence. We spotlight quick wins, data guardrails, and launch checklists proven in Virginia communities.'
}: {
  posts: BlogPostContent[];
  currentPage: number;
  totalPages: number;
  heading?: string;
  description?: string;
} = Astro.props;

const formatDate = new Intl.DateTimeFormat('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});

const resolvePageHref = (pageNumber: number) =>
  pageNumber === 1 ? '/blog/' : `/blog/page/${pageNumber}/`;

const pageNumbers = Array.from({ length: totalPages }, (_, index) => index + 1);
const hasPrevious = currentPage > 1;
const hasNext = currentPage < totalPages;

const toCategorySlug = (value: string) =>
  value
    .toLowerCase()
    .trim()
    .replace(/[^a-z0-9]+/g, '-')
    .replace(/^-+|-+$/g, '');
---

<BaseLayout title="AI Blogs in Virginia" description="Browse AI automation insights curated for Virginia organizations by Binary Ideas.">
  <div class="bg-white w-full min-h-screen flex flex-col relative overflow-x-hidden">
    <Header />

    <main class="z-[1] w-full flex-1 relative bg-[#0a0a0f] pt-[97px]">
      <div class="absolute inset-0 pointer-events-none opacity-50 overflow-hidden">
        <div class="absolute top-0 left-[25%] w-96 h-96">
          <div class="glow-sphere glow-sphere--1 h-full w-full bg-[#2b7fff] rounded-[33554400px] blur-3xl pointer-events-none"></div>
        </div>
        <div class="absolute top-[8%] right-[25%] w-96 h-96">
          <div class="glow-sphere glow-sphere--2 h-full w-full bg-[#ac46ff] rounded-[33554400px] blur-3xl pointer-events-none"></div>
        </div>
        <div class="absolute top-[22%] left-1/2 w-96 h-96 -translate-x-1/2">
          <div class="glow-sphere glow-sphere--3 h-full w-full bg-[#f6329a] rounded-[33554400px] blur-3xl pointer-events-none"></div>
        </div>

        <div class="absolute top-[45%] left-[20%] w-80 h-80 opacity-80">
          <div class="glow-sphere glow-sphere--4 h-full w-full bg-[#ac46ff] rounded-[33554400px] blur-3xl pointer-events-none"></div>
        </div>
        <div class="absolute top-[50%] right-[22%] w-96 h-96 opacity-80">
          <div class="glow-sphere glow-sphere--5 h-full w-full bg-[#2b7fff] rounded-[33554400px] blur-3xl pointer-events-none"></div>
        </div>
        <div class="absolute top-[58%] left-1/2 w-80 h-80 -translate-x-1/2 opacity-80">
          <div class="glow-sphere glow-sphere--6 h-full w-full bg-[#f6329a] rounded-[33554400px] blur-3xl pointer-events-none"></div>
        </div>

        <div class="absolute bottom-[18%] left-[18%] w-72 h-72 opacity-70">
          <div class="glow-sphere glow-sphere--7 h-full w-full bg-[#2b7fff] rounded-[33554400px] blur-3xl pointer-events-none"></div>
        </div>
        <div class="absolute bottom-[12%] right-[24%] w-80 h-80 opacity-70">
          <div class="glow-sphere glow-sphere--8 h-full w-full bg-[#ac46ff] rounded-[33554400px] blur-3xl pointer-events-none"></div>
        </div>
        <div class="absolute bottom-[6%] left-[10%] w-72 h-72 opacity-70">
          <div class="glow-sphere glow-sphere--9 h-full w-full bg-[#f6329a] rounded-[33554400px] blur-3xl pointer-events-none"></div>
        </div>
      </div>

      <div class="relative z-[1] flex flex-col gap-20 py-24">
        <section class="w-full px-4 md:px-8 lg:px-20">
          <div class="max-w-5xl mx-auto text-center flex flex-col gap-6">
            <h1 class="text-3xl sm:text-4xl md:text-5xl font-normal text-white [font-family:'Segoe_UI_Symbol-Regular',Helvetica]">
              {heading}
            </h1>
            <p class="text-base md:text-lg text-[#d0d5db] leading-relaxed [font-family:'Segoe_UI_Symbol-Regular',Helvetica]">
              {description}
            </p>
          </div>
        </section>

          <section class="w-full px-4 md:px-8 lg:px-20">
            <div class="max-w-6xl mx-auto flex flex-col gap-12">
              <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
                {posts.map((post) => {
              const href = `/${post.slugSegments.join('/')}/`;
                  const heroSrc = post.meta.heroImage?.src ?? '/img/blog/default.jpg';
                  const heroAlt = post.meta.heroImage?.alt ?? post.meta.title;
                  const categories = post.categories ?? [];
                  const excerpt = post.excerpt ?? post.meta.description;

                  return (
                    <article class="blog-card overflow-hidden rounded-[28px] border border-[#fffefe1a] bg-[#0f1524]/70 backdrop-blur-md flex flex-col h-full">
                      <a href={href} class="block relative h-56 overflow-hidden">
                        <img
                          src={heroSrc}
                          alt={heroAlt}
                          loading="lazy"
                          class="w-full h-full object-cover transition-transform duration-300 hover:scale-105"
                        />
                      </a>
                      <div class="flex flex-col gap-4 p-6 flex-1">
                      <div class="flex flex-wrap gap-2 items-center text-[13px] uppercase tracking-wide text-[#94a3b8] [font-family:'Segoe_UI_Symbol-Regular',Helvetica]">
                        <time dateTime={post.meta.publishDate}>{formatDate.format(new Date(post.meta.publishDate))}</time>
                        {categories.length > 0 && <span class="opacity-60">•</span>}
                        {categories.length > 0 && (
                          <ul class="flex flex-wrap gap-2">
                            {categories.map((category) => (
                              <li>
                                <a
                                  href={`/blog/category/${toCategorySlug(category)}/`}
                                  class="text-[#94a3b8] hover:text-[#8dc5ff] transition-colors duration-150"
                                >
                                  {category}
                                </a>
                              </li>
                            ))}
                          </ul>
                        )}
                        </div>
                        <h2 class="text-xl md:text-2xl font-semibold text-white leading-snug [font-family:'Segoe_UI_Symbol-Regular',Helvetica]">
                          <a href={href} class="hover:text-[#8dc5ff] transition-colors duration-200">
                            {post.meta.title}
                          </a>
                        </h2>
                        <p class="text-sm md:text-base text-[#c7d2fe] leading-relaxed flex-1 [font-family:'Segoe_UI_Symbol-Regular',Helvetica]">
                          {excerpt}
                        </p>
                        <div class="pt-2">
                          <a
                            href={href}
                            class="inline-flex items-center gap-2 text-sm font-semibold text-white rounded-full border border-white/20 px-4 py-2 transition-colors duration-200 hover:bg-white hover:text-[#0a0a0f]"
                          >
                            Read more
                            <span aria-hidden="true">→</span>
                          </a>
                        </div>
                      </div>
                    </article>
                  );
                })}
              </div>

              {totalPages > 1 && (
                <nav class="flex flex-wrap items-center justify-center gap-3 text-sm text-white [font-family:'Segoe_UI_Symbol-Regular',Helvetica]" aria-label="Pagination">
                  {hasPrevious && (
                    <a
                      href={resolvePageHref(currentPage - 1)}
                      class="pagination-link"
                    >
                      Previous
                    </a>
                  )}
                  {pageNumbers.map((number) => (
                    <a
                      href={resolvePageHref(number)}
                      class={`pagination-number ${number === currentPage ? 'is-active' : ''}`}
                    >
                      {number}
                    </a>
                  ))}
                  {hasNext && (
                    <a
                      href={resolvePageHref(currentPage + 1)}
                      class="pagination-link"
                    >
                      Next
                    </a>
                  )}
                </nav>
              )}
            </div>
          </section>
      </div>

      <section class="relative isolate overflow-hidden px-6 py-24 text-center text-white bg-[linear-gradient(120deg,#06152d_0%,#1a021f_100%)]">
        <div
          class="pointer-events-none absolute left-1/2 top-[-240px] h-[620px] w-[620px] -translate-x-1/2 rounded-full bg-[radial-gradient(circle,rgba(124,58,237,0.45)_0%,rgba(124,58,237,0)_70%)] blur-[140px] opacity-70"
          aria-hidden="true"
        />
        <div
          class="pointer-events-none absolute right-[-220px] top-[160px] h-[540px] w-[540px] rounded-full bg-[radial-gradient(circle,rgba(59,130,246,0.35)_0%,rgba(59,130,246,0)_70%)] blur-[150px] opacity-65"
          aria-hidden="true"
        />
        <div
          class="pointer-events-none absolute left-[-260px] bottom-[-260px] h-[520px] w-[520px] rounded-full bg-[radial-gradient(circle,rgba(168,85,247,0.3)_0%,rgba(168,85,247,0)_70%)] blur-[160px] opacity-60"
          aria-hidden="true"
        />

        <div class="relative mx-auto flex max-w-3xl flex-col items-center gap-8">
          <p class="text-base leading-7 text-[#cbd4e6] sm:text-lg sm:leading-8 [font-family:'Segoe_UI_Symbol-Regular',Helvetica]">
            Need a tailored AI roadmap for your Virginia organization? We build, launch, and support automation systems that your team can trust.
          </p>
          <a
            href="https://api.3sixtycrm.com/widget/bookings/robert-sandiego"
            target="_blank"
            rel="noopener"
            class="inline-flex items-center justify-center rounded-[26px] bg-[linear-gradient(90deg,#3785ff_0%,#b020f5_100%)] px-12 py-5 text-lg font-semibold tracking-wide text-white shadow-[0_22px_55px_rgba(94,117,255,0.45)] transition-transform duration-200 hover:scale-[1.04] focus:outline-none focus-visible:ring-4 focus-visible:ring-white/35"
          >
            Book a Complimentary AI Consultation
          </a>
        </div>
      </section>

      <Footer />
    </main>
  </div>
</BaseLayout>

<style is:inline>
  .glow-sphere {
    animation: glowFloat 20s ease-in-out infinite alternate;
    will-change: transform, opacity;
  }

  .glow-sphere--1 {
    animation-duration: 18s;
    animation-delay: -3s;
  }

  .glow-sphere--2 {
    animation-duration: 22s;
    animation-delay: -7s;
    animation-direction: alternate-reverse;
  }

  .glow-sphere--3 {
    animation-duration: 19s;
    animation-delay: -4s;
  }

  .glow-sphere--4 {
    animation-duration: 17s;
    animation-delay: -9s;
  }

  .glow-sphere--5 {
    animation-duration: 23s;
    animation-delay: -13s;
    animation-direction: alternate-reverse;
  }

  .glow-sphere--6 {
    animation-duration: 16s;
    animation-delay: -6s;
  }

  .glow-sphere--7 {
    animation-duration: 21s;
    animation-delay: -10s;
  }

  .glow-sphere--8 {
    animation-duration: 24s;
    animation-delay: -15s;
    animation-direction: alternate-reverse;
  }

  .glow-sphere--9 {
    animation-duration: 17s;
    animation-delay: -8s;
  }

  .pagination-link,
  .pagination-number {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 44px;
    height: 44px;
    padding: 0 1.25rem;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.2s ease;
  }

  .pagination-link:hover,
  .pagination-number:hover {
    background-color: rgba(255, 255, 255, 0.1);
  }

  .pagination-number.is-active {
    background: linear-gradient(90deg, #3785ff 0%, #b020f5 100%);
    border-color: transparent;
  }

  @keyframes glowFloat {
    0% {
      transform: translate3d(0, 0, 0) scale(1) rotate(0deg);
      opacity: 0.92;
    }

    20% {
      transform: translate3d(70px, -55px, 0) scale(1.08) rotate(2deg);
      opacity: 1;
    }

    40% {
      transform: translate3d(-60px, 45px, 0) scale(0.94) rotate(-2deg);
      opacity: 0.85;
    }

    60% {
      transform: translate3d(80px, 55px, 0) scale(1.12) rotate(3deg);
      opacity: 0.98;
    }

    80% {
      transform: translate3d(-75px, -45px, 0) scale(0.96) rotate(-3deg);
      opacity: 0.88;
    }

    100% {
      transform: translate3d(60px, 35px, 0) scale(1.05) rotate(1deg);
      opacity: 0.95;
    }
  }
</style>

