---
interface FaqItem {
  question: string;
  answer?: string;
}

interface Props {
  titleLeading?: string;
  titleHighlight?: string;
  subtitle?: string;
  faqItems?: FaqItem[];
  sectionId?: string;
}

const defaultFaqItems: FaqItem[] = [
  {
    question: "How long does implementation take?",
    answer: "Most Voice AI Agent implementations are completed within 2-4 weeks, depending on the complexity of your requirements and integrations needed."
  },
  {
    question: "What systems does it integrate with?",
    answer: "Our Voice AI Agents integrate with most major CRM systems, calendar applications, and phone systems commonly used by Northern Virginia businesses."
  },
  {
    question: "Do we need technical expertise?",
    answer: "No technical expertise required on your end. We handle all setup, training, and ongoing maintenance, so you can focus on running your business."
  },
  {
    question: "What kind of results can we expect?",
    answer: "Most clients see immediate improvements in call handling efficiency and customer satisfaction, with measurable cost savings within the first month."
  },
  {
    question: "How much does it cost?",
    answer: "Pricing varies based on your specific needs and call volume. Contact us for a customized quote that fits your budget and requirements."
  }
];

const {
  titleLeading = "Frequently Asked",
  titleHighlight = "Questions",
  subtitle = "Get answers to common questions about Voice AI Agents",
  faqItems = defaultFaqItems,
  sectionId: providedSectionId
} = Astro.props as Props;

const sectionId =
  providedSectionId ?? `faq-section-${Math.random().toString(36).slice(2, 8)}`;
---

<section id={sectionId} class="relative mx-auto mt-24 flex max-w-4xl flex-col items-center px-6 py-20">
  <div class="flex flex-col items-center text-center gap-4">
    <h2 class="[font-family:'Segoe_UI_Symbol-Regular',Helvetica] text-3xl font-semibold leading-tight text-white sm:text-4xl md:text-[48px] md:leading-[58px]">
      <span>{titleLeading} </span>
      <span class="text-transparent bg-clip-text bg-[linear-gradient(90deg,#60a5fa_0%,#8b5cf6_100%)]">
        {titleHighlight}
      </span>
    </h2>
    <p class="[font-family:'Segoe_UI_Symbol-Regular',Helvetica] text-base leading-7 text-[#99a1ae] sm:text-lg">
      {subtitle}
    </p>
  </div>

  <div class="mt-16 flex flex-col gap-5 w-full">
    {faqItems.map((item, index) => (
      <details
        class="group w-full rounded-[18px] border border-[#ffffff1a] bg-[linear-gradient(180deg,rgba(30,31,45,0.95)_0%,rgba(17,18,30,0.95)_100%)] transition-all duration-200 overflow-hidden"
        data-faq-details
      >
        <summary class="flex h-[72px] w-full cursor-pointer list-none items-center justify-between px-8">
          <span class="[font-family:'Segoe_UI_Symbol-Regular',Helvetica] text-white text-lg leading-7">
            {item.question}
          </span>

          <div class="flex h-10 w-10 items-center justify-center rounded-full border border-[#ffffff27] bg-[linear-gradient(160deg,rgba(43,127,255,0.2)_0%,rgba(173,70,255,0.2)_100%)]">
            <img
              class="faq-toggle-icon h-2 w-3 transition-transform duration-300 ease-out"
              alt="Expand"
              src="/img/vector-8.svg"
              data-faq-icon
              data-expand-alt="Expand"
              data-collapse-alt="Collapse"
              loading="lazy"
              aria-hidden="true"
            />
          </div>
        </summary>

        <div class="faq-answer px-8 pb-8">
          <div
            class="faq-answer-box mt-4 rounded-[16px] border border-[#ffffff12] bg-[linear-gradient(180deg,rgba(45,48,68,0.9)_0%,rgba(23,24,36,0.95)_100%)] p-6 text-[#d0d5db]"
            id={`${sectionId}-answer-${index}`}
          >
            <p
              class="[font-family:'Segoe_UI_Symbol-Regular',Helvetica] text-base leading-7"
              set:html={item.answer}
            />
          </div>
        </div>
      </details>
    ))}
  </div>
</section>

<script is:inline define:vars={{ sectionId }}>
  (() => {
    const section = document.getElementById(sectionId);
    if (!section) return;

    const detailsElements = Array.from(
      section.querySelectorAll('[data-faq-details]')
    );

    detailsElements.forEach((details) => {
      const icon = details.querySelector('[data-faq-icon]');
      if (icon) {
        const expandAlt = icon.getAttribute('data-expand-alt') || 'Expand';
        icon.setAttribute('alt', expandAlt);
      }

      details.addEventListener('toggle', () => {
        if (details.open) {
          detailsElements.forEach((other) => {
            if (other === details || !other.open) return;
            other.open = false;
            const otherIcon = other.querySelector('[data-faq-icon]');
            if (otherIcon) {
              const otherExpandAlt =
                otherIcon.getAttribute('data-expand-alt') || 'Expand';
              otherIcon.setAttribute('alt', otherExpandAlt);
            }
          });
        }

        const currentIcon = details.querySelector('[data-faq-icon]');
        if (currentIcon) {
          const nextAlt = details.open
            ? currentIcon.getAttribute('data-collapse-alt') || 'Collapse'
            : currentIcon.getAttribute('data-expand-alt') || 'Expand';
          currentIcon.setAttribute('alt', nextAlt);
        }
      });
    });
  })();
</script>

<style is:global>
  /* Styles injected for FaqSection */
  details[data-faq-details] summary::-webkit-details-marker {
    display: none;
  }

  details[data-faq-details] summary {
    outline: none;
  }

  details[data-faq-details][open] {
    border-color: #ffffff33;
  }

  details[data-faq-details] .faq-answer {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.35s ease;
  }

  details[data-faq-details][open] .faq-answer {
    max-height: 320px;
  }

  details[data-faq-details] .faq-answer-box {
    opacity: 0;
    transform: translateY(-8px);
    transition: opacity 0.3s ease, transform 0.3s ease;
  }

  details[data-faq-details][open] .faq-answer-box {
    opacity: 1;
    transform: translateY(0);
  }

  details[data-faq-details][open] .faq-toggle-icon {
    transform: rotate(180deg);
  }
</style>

