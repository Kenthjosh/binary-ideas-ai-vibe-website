---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import BlogPostPage from '../components/Blog/PostPage.astro';
import { seoPagesContent, seoPagesContentMap } from '../data/seo-pages/content';
import { blogPostsContent, blogPostsContentMap } from '../data/blogs/content';

export async function getStaticPaths() {
  const seen = new Set<string>();
  const paths: { params: { seoPages: string } }[] = [];

  for (const post of blogPostsContent) {
    const slug = post.slugSegments.join('/');
    if (seen.has(slug)) continue;
    paths.push({
      params: {
        seoPages: slug
      }
    });
    seen.add(slug);
  }

  for (const page of seoPagesContent) {
    const slug = page.slugSegments.join('/');
    if (seen.has(slug)) continue;
    paths.push({
      params: {
        seoPages: slug
      }
    });
    seen.add(slug);
  }

  return paths;
}

const slugParam = Astro.params.seoPages;
const slugKey =
  typeof slugParam === 'string'
    ? slugParam
    : Array.isArray(slugParam)
      ? slugParam.join('/')
      : '';
const blogEntry = blogPostsContentMap[slugKey];
const pageEntry = seoPagesContentMap[slugKey];

if (!blogEntry && !pageEntry) {
  throw new Error(`Page not found for slug: ${slugKey}`);
}

const meta = pageEntry?.meta ?? { title: '', description: '' };
const pageTitle = pageEntry?.pageTitle ?? '';
const Page = pageEntry?.Page;
---

{blogEntry ? (
  <BlogPostPage postEntry={blogEntry} slugKey={slugKey} />
) : (
  <BaseLayout title={meta.title} description={meta.description}>
    <div class="bg-white w-full min-h-screen flex flex-col relative overflow-x-hidden">
      <Header />

      <main class="z-[1] w-full flex-1 relative bg-[#0a0a0f] pt-[97px]">
        <div class="absolute inset-0 pointer-events-none opacity-50 overflow-hidden">
          <div class="absolute top-0 left-[25%] w-96 h-96">
            <div class="glow-sphere glow-sphere--1 h-full w-full bg-[#2b7fff] rounded-[33554400px] blur-3xl pointer-events-none"></div>
          </div>
          <div class="absolute top-[8%] right-[25%] w-96 h-96">
            <div class="glow-sphere glow-sphere--2 h-full w-full bg-[#ac46ff] rounded-[33554400px] blur-3xl pointer-events-none"></div>
          </div>
          <div class="absolute top-[22%] left-1/2 w-96 h-96 -translate-x-1/2">
            <div class="glow-sphere glow-sphere--3 h-full w-full bg-[#f6329a] rounded-[33554400px] blur-3xl pointer-events-none"></div>
          </div>

          <div class="absolute top-[45%] left-[20%] w-80 h-80 opacity-80">
            <div class="glow-sphere glow-sphere--4 h-full w-full bg-[#ac46ff] rounded-[33554400px] blur-3xl pointer-events-none"></div>
          </div>
          <div class="absolute top-[50%] right-[22%] w-96 h-96 opacity-80">
            <div class="glow-sphere glow-sphere--5 h-full w-full bg-[#2b7fff] rounded-[33554400px] blur-3xl pointer-events-none"></div>
          </div>
          <div class="absolute top-[58%] left-1/2 w-80 h-80 -translate-x-1/2 opacity-80">
            <div class="glow-sphere glow-sphere--6 h-full w-full bg-[#f6329a] rounded-[33554400px] blur-3xl pointer-events-none"></div>
          </div>

          <div class="absolute bottom-[18%] left-[18%] w-72 h-72 opacity-70">
            <div class="glow-sphere glow-sphere--7 h-full w-full bg-[#2b7fff] rounded-[33554400px] blur-3xl pointer-events-none"></div>
          </div>
          <div class="absolute bottom-[12%] right-[24%] w-80 h-80 opacity-70">
            <div class="glow-sphere glow-sphere--8 h-full w-full bg-[#ac46ff] rounded-[33554400px] blur-3xl pointer-events-none"></div>
          </div>
          <div class="absolute bottom-[6%] left-[10%] w-72 h-72 opacity-70">
            <div class="glow-sphere glow-sphere--9 h-full w-full bg-[#f6329a] rounded-[33554400px] blur-3xl pointer-events-none"></div>
          </div>
        </div>

        <div class="relative z-[1] flex flex-col gap-16 py-20">
          <section class="w-full px-4 md:px-8 lg:px-20">
            <div class="max-w-4xl mx-auto text-center flex flex-col gap-6">
              <h1 class="text-3xl sm:text-4xl md:text-5xl font-normal text-white [font-family:'Segoe_UI_Symbol-Regular',Helvetica]">
                {pageTitle}
              </h1>
            </div>
          </section>
          <section class="w-full px-4 md:px-8 lg:px-20">
            <div class="max-w-4xl mx-auto flex flex-col gap-8">
              <article class="seo-content-body space-y-8 text-base md:text-lg text-[#d0d5db] leading-relaxed [font-family:'Segoe_UI_Symbol-Regular',Helvetica]">
                {Page ? <Page /> : null}
              </article>
            </div>
          </section>
        </div>

        <section class="relative isolate overflow-hidden px-6 py-24 text-center text-white bg-[linear-gradient(120deg,#06152d_0%,#1a021f_100%)]">
          <div
            class="pointer-events-none absolute left-1/2 top-[-240px] h-[620px] w-[620px] -translate-x-1/2 rounded-full bg-[radial-gradient(circle,rgba(124,58,237,0.45)_0%,rgba(124,58,237,0)_70%)] blur-[140px] opacity-70"
            aria-hidden="true"
          />
          <div
            class="pointer-events-none absolute right-[-220px] top-[160px] h-[540px] w-[540px] rounded-full bg-[radial-gradient(circle,rgba(59,130,246,0.35)_0%,rgba(59,130,246,0)_70%)] blur-[150px] opacity-65"
            aria-hidden="true"
          />
          <div
            class="pointer-events-none absolute left-[-260px] bottom-[-260px] h-[520px] w-[520px] rounded-full bg-[radial-gradient(circle,rgba(168,85,247,0.3)_0%,rgba(168,85,247,0)_70%)] blur-[160px] opacity-60"
            aria-hidden="true"
          />

          <div class="relative mx-auto flex max-w-3xl flex-col items-center gap-8">
            <p class="text-base leading-7 text-[#cbd4e6] sm:text-lg sm:leading-8 [font-family:'Segoe_UI_Symbol-Regular',Helvetica]">
              Don't let inefficient processes hold your business back - discover how AI automation can transform your operations and boost productivity!
            </p>
            <a
              href="https://api.3sixtycrm.com/widget/bookings/robert-sandiego"
              target="_blank"
              rel="noopener"
              class="inline-flex items-center justify-center rounded-[26px] bg-[linear-gradient(90deg,#3785ff_0%,#b020f5_100%)] px-12 py-5 text-lg font-semibold tracking-wide text-white shadow-[0_22px_55px_rgba(94,117,255,0.45)] transition-transform duration-200 hover:scale-[1.04] focus:outline-none focus-visible:ring-4 focus-visible:ring-white/35"
            >
              Book a Complimentary AI Consultation
            </a>
          </div>
        </section>

        <Footer />
      </main>
    </div>
  </BaseLayout>
)}

<style is:inline>
  .glow-sphere {
    animation: glowFloat 20s ease-in-out infinite alternate;
    will-change: transform, opacity;
  }

  .glow-sphere--1 {
    animation-duration: 18s;
    animation-delay: -3s;
  }

  .glow-sphere--2 {
    animation-duration: 22s;
    animation-delay: -7s;
    animation-direction: alternate-reverse;
  }

  .glow-sphere--3 {
    animation-duration: 19s;
    animation-delay: -4s;
  }

  .glow-sphere--4 {
    animation-duration: 17s;
    animation-delay: -9s;
  }

  .glow-sphere--5 {
    animation-duration: 23s;
    animation-delay: -13s;
    animation-direction: alternate-reverse;
  }

  .glow-sphere--6 {
    animation-duration: 16s;
    animation-delay: -6s;
  }

  .glow-sphere--7 {
    animation-duration: 21s;
    animation-delay: -10s;
  }

  .glow-sphere--8 {
    animation-duration: 24s;
    animation-delay: -15s;
    animation-direction: alternate-reverse;
  }

  .glow-sphere--9 {
    animation-duration: 17s;
    animation-delay: -8s;
  }

  @keyframes glowFloat {
    0% {
      transform: translate3d(0, 0, 0) scale(1) rotate(0deg);
      opacity: 0.92;
    }

    20% {
      transform: translate3d(70px, -55px, 0) scale(1.08) rotate(2deg);
      opacity: 1;
    }

    40% {
      transform: translate3d(-60px, 45px, 0) scale(0.94) rotate(-2deg);
      opacity: 0.85;
    }

    60% {
      transform: translate3d(80px, 55px, 0) scale(1.12) rotate(3deg);
      opacity: 0.98;
    }

    80% {
      transform: translate3d(-75px, -45px, 0) scale(0.96) rotate(-3deg);
      opacity: 0.88;
    }

    100% {
      transform: translate3d(60px, 35px, 0) scale(1.05) rotate(1deg);
      opacity: 0.95;
    }
  }
</style>

<style is:global>
  .seo-content-body > *:first-child {
    margin-top: 0;
  }

  .seo-content-body p {
    margin-bottom: 1.5rem;
    font-size: 1rem;
    line-height: 1.75;
    color: #d0d5db;
  }

  @media (min-width: 768px) {
    .seo-content-body p {
      font-size: 1.125rem;
    }
  }

  .seo-content-body h2 {
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    font-size: 1.75rem;
    line-height: 1.3;
    font-weight: 400;
    color: #ffffff;
  }

  @media (min-width: 768px) {
    .seo-content-body h2 {
      font-size: 2rem;
    }
  }

  .seo-content-body h3 {
    margin-top: 2rem;
    margin-bottom: 0.75rem;
    font-size: 1.5rem;
    line-height: 1.35;
    font-weight: 400;
    color: #ffffff;
  }

  @media (min-width: 768px) {
    .seo-content-body h3 {
      font-size: 1.75rem;
    }
  }

  .seo-content-body h4,
  .seo-content-body h5 {
    margin-top: 1.75rem;
    margin-bottom: 0.75rem;
    font-size: 1.25rem;
    line-height: 1.4;
    font-weight: 400;
    color: #ffffff;
  }

  .seo-content-body ul,
  .seo-content-body ol {
    margin-bottom: 1.5rem;
    padding-left: 1.25rem;
    color: #d0d5db;
    font-size: 1rem;
    line-height: 1.75;
  }

  @media (min-width: 768px) {
    .seo-content-body ul,
    .seo-content-body ol {
      font-size: 1.125rem;
    }
  }

  .seo-content-body ul {
    list-style-type: disc;
  }

  .seo-content-body ol {
    list-style-type: decimal;
  }

  .seo-content-body li {
    margin-bottom: 0.5rem;
  }

  .seo-content-body figure {
    margin: 2rem 0;
    border: 1px solid rgba(255, 254, 254, 0.1);
    border-radius: 1rem;
    overflow: hidden;
    background: rgba(255, 254, 254, 0.05);
    backdrop-filter: blur(6px);
  }

  .seo-content-body figure img {
    display: block;
    width: 100%;
    height: auto;
    object-fit: cover;
  }

  .seo-content-body figcaption {
    padding: 0.75rem 1.25rem;
    font-size: 0.875rem;
    color: #99a1ae;
  }

  .seo-content-body strong {
    color: #ffffff;
  }

  .seo-content-body a {
    color: #2b7fff;
    text-decoration: underline;
    transition: color 150ms ease, text-decoration-color 150ms ease;
  }

  .seo-content-body a:hover {
    color: #8dc5ff;
  }
</style>

